<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0100)http://groups.google.com/groups?hl=en&rnum=5&selm=KYFv3.2057%2436.279559%40typhoon-sf.snfc21.pbi.net -->
<HTML><HEAD><TITLE>Google Search:</TITLE>
<META content="text/html; charset=ISO-8859-1" http-equiv=content-type>
<STYLE>BODY {
	FONT-FAMILY: arial,sans-serif
}
TD {
	FONT-FAMILY: arial,sans-serif
}
DIV {
	FONT-FAMILY: arial,sans-serif
}
.p {
	FONT-FAMILY: arial,sans-serif
}
A {
	FONT-FAMILY: arial,sans-serif
}
DIV {
	COLOR: #000
}
TD {
	COLOR: #000
}
.f {
	COLOR: #6f6f6f
}
.fl:link {
	COLOR: #6f6f6f
}
A:link {
	COLOR: #00c
}
.w {
	COLOR: #00c
}
A.w:link {
	COLOR: #00c
}
.w A:link {
	COLOR: #00c
}
A:visited {
	COLOR: #551a8b
}
.fl:visited {
	COLOR: #551a8b
}
A:active {
	COLOR: #f00
}
.fl:active {
	COLOR: #f00
}
.t A:link {
	COLOR: #000000
}
.t A:active {
	COLOR: #000000
}
.t A:visited {
	COLOR: #000000
}
.t {
	COLOR: #000000
}
.t {
	BACKGROUND-COLOR: #ffcc33
}
.h {
	COLOR: #ddaa11; FONT-SIZE: 14px
}
.i {
	COLOR: #a90a08
}
.i:link {
	COLOR: #a90a08
}
.a {
	COLOR: #008000
}
.a:link {
	COLOR: #008000
}
.z {
	DISPLAY: none
}
DIV.n {
	MARGIN-TOP: 1ex
}
.n A {
	COLOR: #000; FONT-SIZE: 10pt
}
.n .i {
	FONT-SIZE: 10pt; FONT-WEIGHT: bold
}
.q A:visited {
	COLOR: #00c; TEXT-DECORATION: none
}
.q A:link {
	COLOR: #00c; TEXT-DECORATION: none
}
.q A:active {
	COLOR: #00c; TEXT-DECORATION: none
}
.q {
	COLOR: #00c; TEXT-DECORATION: none
}
.b {
	COLOR: #00c; FONT-SIZE: 12pt; FONT-WEIGHT: bold
}
</STYLE>

<META content="MSHTML 5.00.2614.3500" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff onload=document.gs.reset()>
<TABLE border=0 cellPadding=2 cellSpacing=0>
  <TBODY>
  <TR>
    <TD rowSpan=3 vAlign=top>
      <TABLE border=0 cellPadding=0 cellSpacing=0>
        <TBODY>
        <TR>
          <TD align=right vAlign=bottom><A 
            href="http://groups.google.com/"><IMG alt="Go to Google Groups Home" 
            border=0 height=58 src="Google Search_bestanden/res0.gif" 
            width=110></A></TD>
          <TD vAlign=bottom><A href="http://groups.google.com/"><IMG alt="" 
            border=0 height=58 src="Google Search_bestanden/res1.gif" 
            width=38></A></TD>
          <TD vAlign=bottom><A href="http://groups.google.com/"><IMG alt="" 
            border=0 height=58 src="Google Search_bestanden/res2.gif" 
            width=52></A></TD></TR>
        <TR>
          <TD align=right class=h vAlign=top><B>Groups</B></TD>
          <TD vAlign=top><A href="http://groups.google.com/"><IMG alt="" 
            border=0 height=20 src="Google Search_bestanden/res3.gif" 
            width=38></A></TD>
          <TD vAlign=top><FONT color=#6f6f6f 
            style="FONT-SIZE: 14px">&nbsp;</FONT></TD></TR></TBODY></TABLE></TD>
    <TD noWrap><FONT size=-1>&nbsp;</FONT></TD></TR>
  <TR>
    <TD noWrap vAlign=top>
      <TABLE border=0 cellPadding=0 cellSpacing=0>
        <TBODY>
        <TR>
          <TD noWrap>
            <FORM action=/groups method=get name=gs><INPUT maxLength=2048 name=q 
            size=25><FONT size=-1> <INPUT name=hl type=hidden value=en><INPUT name=btnG type=submit value="Google Search"> 
          </FONT></TD>
          <TD noWrap><FONT size=-2>&nbsp;&#8226;&nbsp;<A 
            href="http://groups.google.com/advanced_group_search?hl=en">Advanced&nbsp;Groups&nbsp;Search</A><BR>&nbsp;&#8226;&nbsp;<A 
            href="http://groups.google.com/googlegroups/help.html">Groups 
            Help</A></FONT></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD><FONT size=-1>&nbsp;</FONT></TD></TR></FORM></TBODY></TABLE>
<TABLE border=0 cellPadding=2 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD bgColor=#ffcc33 noWrap><FONT color=#000000 size=-1><B>Groups search 
      result 5</B> for <B></B></FONT></TR></TBODY></TABLE><BR clear=all>
<TABLE bgColor=#e0e0e0 border=0 cellPadding=2 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD><FONT face=arial,sans-serif>
      <TABLE align=right border=0 cellPadding=0 cellSpacing=0>
        <TBODY>
        <TR>
          <TD><FONT face=arial,sans-serif></FONT></TD></TR></TBODY></TABLE>From: <A 
      href="http://groups.google.com/groups?hl=en&amp;q=author:gregm%40northernembedded.com.nospam+">Greg 
      Miller</A> (<A 
      href="mailto:gregm@northernembedded.com.nospam">gregm@northernembedded.com.nospam</A>)<BR>Subject: 
      Re: Parallel port IRQ <BR>Newsgroups: <A 
      href="http://groups.google.com/groups?hl=en&amp;group=comp.os.ms-windows.programmer.nt.kernel-mode">comp.os.ms-windows.programmer.nt.kernel-mode</A><BR>
      <TABLE align=right border=0 cellPadding=0 cellSpacing=0>
        <TBODY>
        <TR>
          <TD><FONT face=arial,sans-serif>View: <A 
            href="http://groups.google.com/groups?hl=en&amp;threadm=KYFv3.2057%2436.279559%40typhoon-sf.snfc21.pbi.net&amp;rnum=5&amp;prev=/groups%3Fhl%3Den%26rnum%3D5%26selm%3DKYFv3.2057%252436.279559%2540typhoon-sf.snfc21.pbi.net">Complete 
            Thread (6 articles)</A> | <A 
            href="http://groups.google.com/groups?selm=KYFv3.2057%2436.279559%40typhoon-sf.snfc21.pbi.net&amp;output=gplain">Original 
            Format</A></FONT></TD></TR></TBODY></TABLE>Date: 1999/08/21 
  <BR></FONT></TD></TR></TBODY></TABLE><PRE>Paul Hoepping &lt;paul@hed.de&gt; wrote in message <A href="http://groups.google.com/groups?selm=VA.000002c3.06a65c13%40mobile800">news:VA.000002c3.06a65c13@mobile800</A>...
<FONT color=#660066>&gt; Therefore, wrong IRQ assignments usually cause no problem.</FONT>

Let me ensure that I'm reading you correctly -- you're finding situations where the
OS is incorrectly assigning an IRQ value to a given parallel port?

<FONT color=#660066>&gt; The driver works fine if all parallel ports are assigned an IRQ, and if
&gt; it is the same IRQ that is actually used by the hardware. Interrupt
&gt; conflicts are logged in the NT system event log.</FONT>

If you're talking about NT4, I'd suggest taking a look at the parport driver's
source itself.  The source for the driver is included in the DDK.

If you're talking about NT5, there's more involved than that.
IOCTL_INTERNAL_PARALLEL_CONNECT_INTERRUPT requires two things to function
correctly under NT5 (Win 2000):

 - The user must have declared the parallel port as having an interrupt.
   Apparently since almost all parallel ports in use are used for printers, and
   therefore need no IRQ, W2K defaults to not assigning any interrupt
   to it.  The user must select:

   Control Panel/Administrative Tools/System Tools/Device Manager/Ports

   Then select the individual parallel port in question, then select
   'properties' (right mouse button on the port, select 'properties' from
   the menu).

   Then select the 'Port Settings' tab.

   Then select 'Use any interrupt assigned to the Port'.

 - Secondly, and I can see no user method of selecting this, the parallel port
   driver requires a registry key before permitting the given IOCTL to function:

   First, the location of the given key on my machine is:

   LocalMachine/System/CurrentControlSet/Enum/Root/*PNP0400

   I don't know, however, how this key is intended to be located.  I suspect it has
   to do with the PNP mechanism, which I know little of.  Fortunately, the key location
   has been constant on all of the machines I've seen -- but as Microsoft has yet to
   document this (as far as I've seen), YMMV.

   Each named key under *PNP0400 represents a parallel port.  For instance, you might
   find:

   LocalMachine/System/CurrentControlSet/Enum/Root/*PNP0400/PnPBIOS_14

   (Which is what I get on my machine.  My parallel port is called 'PnPBIOS_14'.)

   Under each of these should be at least "Device Parameters" and "LogConf" keys.
   Under each device's "Device Parameters" key needs to be a Value of type
   DWORD named 'EnableConnectInterruptIoctl', and the value must be non-zero.

   Thus, on my machine:

   LocalMachine/System/CurrentControlSet/Enum/Root/*PNP0400/PnPBIOS_14/
   Device Parameters/EnableConnectInterruptIoctl (DWORD) = 1

   Without this key, the parport driver will intentionally fail any attempt to
   connect to the port's interrupt.

I hope anything within helps!

 - Greg Miller</PRE>
<CENTER>
<P>
<HR class=z>

<TABLE border=0 cellPadding=2 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD align=middle class=t><FONT size=-1><A 
      href="http://groups.google.com/url?q=http://www.google.com&amp;test=gbacktohome/">Google&nbsp;Home</A> 
      - <A href="http://groups.google.com/ads/">Advertise&nbsp;with&nbsp;Us</A> 
      - <A 
      href="http://groups.google.com/services/">Add&nbsp;Google&nbsp;to&nbsp;Your&nbsp;Site</A> 
      - <A href="http://groups.google.com/news/">News and Resources</A> - <A 
      href="http://groups.google.com/language_tools?hl=en">Language Tools</A> - 
      <A href="http://groups.google.com/about.html">Jobs, Press, Cool 
      Stuff...</A></FONT></TR></TBODY></TABLE><BR><FONT class=p size=-1>©2002 
Google</FONT></CENTER></BODY></HTML>
